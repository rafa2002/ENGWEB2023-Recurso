extends layout
block content
  .w3-card-4
    - let operation = null

    - for (const tratamento of tratamentos) {
      - const foundOperation = tratamento.operacoes.find(operacao => operacao.codigo === code)
      - if (foundOperation) {
        - operation = foundOperation
        - break
      - }
    - }
    header.w3-container.w3-teal
      h1 Utilizadores com Intervenção #{code}
    .w3-container
      h4 Código: #{operation.codigo}
      h4 Nome: #{operation.nome}
      h4 Descricao: #{operation.descricao}
      table.w3-table-all
        tr
          th Id
          th Data
          th Nome
          th Idade 
          th Sexo
          th Número de intervenções
        
        each tratamento in tratamentos
          if tratamento.operacoes.some(operacao => operacao.codigo === code)
            tr
              td #[a(href="/"+tratamento._id) #{tratamento._id}]
              td= tratamento.data
              td= tratamento.nome
              td= tratamento.idade
              td= tratamento.sexo
              td= tratamento.nr_operacoes
              
    footer.w3-container.w3-teal
      h5 Generated by A97642 - #[a(href="/") Return]